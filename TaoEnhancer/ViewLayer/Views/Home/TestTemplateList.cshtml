@using Common
@{
    ViewData["Title"] = "Správa zadání testů";
}

@functions {

    public List<(string, string, string)> LoadTests()
    {
        List<(string, string, string)> testIdentifiers = new List<(string, string, string)>();
        string subDirectory = "";

        foreach (var directory in Directory.GetDirectories(Settings.GetTestsPath()))
        {
            string[] splitDirectoryBySlash = directory.Split(@"\");
            string nameIdentifier = splitDirectoryBySlash[splitDirectoryBySlash.Length - 1].ToString();
            string title = "";
            string numberidentifier = "";

            try
            {
                foreach (var directory_ in Directory.GetDirectories(directory + "\\tests"))
                {
                    string[] splitDirectory_BySlash = directory_.Split(@"\");
                    numberidentifier = splitDirectory_BySlash[splitDirectory_BySlash.Length - 1].ToString();
                    subDirectory = directory_;
                }
            }
            catch
            {
                continue;
            }

            XmlReader xmlReader = XmlReader.Create(subDirectory + "\\test.xml");
            while (xmlReader.Read())
            {
                if ((xmlReader.NodeType == XmlNodeType.Element) && (xmlReader.Name == "assessmentTest"))
                {
                    if (xmlReader.HasAttributes)
                    {
                        title = xmlReader.GetAttribute("title");
                        testIdentifiers.Add((nameIdentifier, numberidentifier, title));
                    }
                }
            }

        }

        return testIdentifiers;
    }

}
 
<header class="header">
    <div class="header-content content-width">
        <div class="header-left">
            <a class="header-button button button-transparent material-icons" title="Zpět" asp-area="" asp-controller="Home" asp-action="TeacherMenu">arrow_back</a>
        </div>
        <h1 class="header-center header-title title" title="@ViewData["Title"]">@ViewData["Title"]</h1>
        <div class="header-right">
            <a class="header-button button button-transparent material-icons g_id_signout" title="Odhlásit se" asp-area="" asp-controller="Account" asp-action="SignOut">logout</a>
        </div>
    </div>
</header>
<main class="main content-width">
    <section class="section">
        <article class="article">
            <div class="article-content">
                <table class="article-table">
                    <tr>
                        <th>Jméno ve složce</th>
                        <th>Identifikátor</th>
                        <th>Nadpis</th>
                        <th>Správa</th>
                    </tr>
                    @foreach ((string, string, string) testIdentifiers in LoadTests())
                    {
                        <tr>
                            <td>@testIdentifiers.Item1</td>
                            <td>@testIdentifiers.Item2</td>
                            <td>@testIdentifiers.Item3</td>
                            <td><a class="button" title="Správa testu"
                                asp-area="" 
                                asp-controller="Home" 
                                asp-action="TestTemplate" 
                                asp-route-testNameIdentifier="@testIdentifiers.Item1" 
                                asp-route-testNumberIdentifier="@testIdentifiers.Item2">Správa testu</a></td>
                        </tr>
                    }
                </table>
            </div>
        </article>
    </section>
</main>